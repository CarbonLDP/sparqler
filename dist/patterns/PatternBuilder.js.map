{"version":3,"sources":["patterns/PatternBuilder.ts"],"names":[],"mappings":";;AAUA,2DAGsC;AACtC,mDAYkC;AAClC,qDASmC;AACnC,0CAGyB;AACzB,oDAAyD;AAGzD;IASC,wBAAa,QAAoB;QAChC,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;IAC1B,CAAC;IARD,sBAAkB,2BAAS;aAA3B,cAA0C,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC;;;OAAA;IAAA,CAAC;IAE5D,sBAAW,qCAAS;aAApB,cAAmC,MAAM,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC,CAAC;;;OAAA;IAAA,CAAC;IAQtE,iCAAQ,GAAR,UAAU,GAAU;QACnB,MAAM,CAAC,IAAI,kBAAQ,CAAE,IAAI,CAAC,QAAQ,EAAE,GAAG,CAAE,CAAC;IAC3C,CAAC;IAED,4BAAG,GAAH,UAAK,IAAW;QACf,MAAM,CAAC,IAAI,kBAAQ,CAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAE,CAAC;IAC5C,CAAC;IAKD,gCAAO,GAAP,UAAS,KAAK;QACb,EAAE,CAAA,CAAE,OAAO,KAAK,KAAK,QAAQ,IAAI,KAAK,YAAY,MAAO,CAAC;YACzD,MAAM,CAAC,IAAI,oBAAU,CAAE,IAAI,CAAC,QAAQ,EAAE,KAAe,CAAE,CAAC;QAEzD,EAAE,CAAA,CAAE,OAAO,KAAK,KAAK,QAAQ,IAAI,KAAK,YAAY,MAAO,CAAC;YACzD,MAAM,CAAC,IAAI,wBAAc,CAAE,IAAI,CAAC,QAAQ,EAAE,KAAe,CAAE,CAAC;QAE7D,EAAE,CAAA,CAAE,OAAO,KAAK,KAAK,SAAS,IAAI,KAAK,YAAY,OAAQ,CAAC;YAC3D,MAAM,CAAC,IAAI,wBAAc,CAAE,IAAI,CAAC,QAAQ,EAAE,KAAgB,CAAE,CAAC;QAE9D,MAAM,IAAI,KAAK,CAAE,iEAAiE,CAAE,CAAC;IACtF,CAAC;IAED,mCAAU,GAAV;QAAY,gBAAuF;aAAvF,UAAuF,EAAvF,qBAAuF,EAAvF,IAAuF;YAAvF,2BAAuF;;QAClG,EAAE,CAAA,CAAE,MAAM,CAAC,MAAM,KAAK,CAAE,CAAC;YAAC,MAAM,KAAK,CAAE,gEAAgE,CAAE,CAAC;QAC1G,MAAM,CAAC,IAAI,oBAAU,CAAE,IAAI,CAAC,QAAQ,EAAE,MAAM,CAAE,CAAC;IAChD,CAAC;IAED,kCAAS,GAAT;QACC,MAAM,CAAC,IAAI,mBAAS,CAAE,IAAI,CAAC,QAAQ,CAAE,CAAC;IACvC,CAAC;IAMD,8BAAK,GAAL,UAAO,aAAa,EAAE,QAAQ;QAC7B,IAAI,KAAK,GAAW,CAAE,OAAO,aAAa,KAAK,QAAQ,CAAE;cACtD,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAE,aAAa,CAAE;cAC1C,aAAa,CAAC,aAAa,EAAE,CAAC;QAEjC,IAAI,aAAa,GAAW,yBAAc,CAAE,QAAQ,CAAE,CAAC;QACvD,MAAM,CAAC,IAAI,8BAAiB,EAAI,cAAK,SAAK,KAAK,EAAK,aAAa,EAAI,CAAC;IACvE,CAAC;IAID,iCAAQ,GAAR,UAAU,QAAQ;QACjB,IAAI,aAAa,GAAW,yBAAc,CAAE,QAAQ,CAAE,CAAC;QAEvD,MAAM,CAAC,IAAI,8BAAiB,EAAI,iBAAQ,SAAK,aAAa,EAAI,CAAC;IAChE,CAAC;IAMD,8BAAK,GAAL,UAAO,SAAS,EAAE,SAAS;QAC1B,IAAI,iBAAiB,GAAW,yBAAc,CAAE,SAAS,CAAE,CAAC;QAC5D,IAAI,kBAAkB,GAAW,yBAAc,CAAE,SAAS,CAAE,CAAC;QAE7D,MAAM,CAAC,IAAI,8BAAiB,CAAO,iBAAiB,SAAE,cAAK,GAAK,kBAAkB,EAAI,CAAC;IACxF,CAAC;IAID,8BAAK,GAAL;QAAO,kBAA0B;aAA1B,UAA0B,EAA1B,qBAA0B,EAA1B,IAA0B;YAA1B,6BAA0B;;QAChC,IAAI,aAAa,GAAW,yBAAc,CAAE,QAAQ,CAAE,CAAC;QAEvD,MAAM,CAAC,IAAI,8BAAiB,EAAI,cAAK,SAAK,aAAa,EAAI,CAAC;IAC7D,CAAC;IAID,+BAAM,GAAN;QAAQ,mBAAuB;aAAvB,UAAuB,EAAvB,qBAAuB,EAAvB,IAAuB;YAAvB,8BAAuB;;QAC9B,MAAM,CAAC,IAAI,0BAAa,CAAE,IAAI,CAAC,QAAQ,EAAE,SAAS,CAAE,CAAC;IACtD,CAAC;IAED,gCAAO,GAAP,UAAS,QAAqC,EAAE,QAAsC;QACrF,IAAM,aAAa,GAAW,OAAO,QAAQ,KAAK,QAAQ;YACzD,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAE,QAAQ,CAAE;YACrC,QAAQ,CAAC,aAAa,EAAE,CAAC;QAE1B,IAAM,aAAa,GAAW,yBAAc,CAAE,QAAQ,CAAE,CAAC;QACzD,MAAM,CAAC,IAAI,8BAAiB,EAAI,gBAAO,SAAK,aAAa,EAAK,aAAa,EAAI,CAAC;IACjF,CAAC;IAED,sCAAa,GAAb,UAAe,QAAqC,EAAE,QAAsC;QAC3F,IAAM,aAAa,GAAW,OAAO,QAAQ,KAAK,QAAQ;YACzD,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAE,QAAQ,CAAE;YACrC,QAAQ,CAAC,aAAa,EAAE,CAAC;QAE1B,IAAM,aAAa,GAAW,yBAAc,CAAE,QAAQ,CAAE,CAAC;QACzD,MAAM,CAAC,IAAI,8BAAiB,EAAI,gBAAO,EAAE,eAAM,SAAK,aAAa,EAAK,aAAa,EAAI,CAAC;IACzF,CAAC;IAED,6BAAI,GAAJ,UAAM,aAAoB,EAAE,QAA0B;QACrD,QAAQ,GAAG,OAAO,QAAQ,KAAK,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAE,QAAQ,CAAE,GAAG,QAAQ,CAAC;QAC1E,IAAM,aAAa,IAAa,aAAI,EAAE,yBAAgB,EAAE,IAAI,sBAAa,CAAE,aAAa,CAAE,EAAE,WAAE,SAAK,QAAQ,CAAC,aAAa,EAAE,GAAE,0BAAiB,EAAE,CAAC;QACjJ,MAAM,CAAC,IAAI,8BAAiB,CAAE,aAAa,CAAE,CAAC;IAC/C,CAAC;IAED,+BAAM,GAAN,UAAQ,aAAoB;QAC3B,MAAM,CAAC,IAAI,8BAAiB,CAAE,CAAE,eAAM,EAAE,IAAI,sBAAa,CAAE,aAAa,CAAE,CAAE,CAAE,CAAC;IAChF,CAAC;IAEF,qBAAC;AAAD,CAxHA,AAwHC,IAAA;AAxHY,wCAAc;AA0H3B,kBAAe,cAAc,CAAC","file":"PatternBuilder.js","sourcesContent":["import { IRIResolver } from \"sparqler/iri/IRIResolver\";\nimport {\n\tGraphPattern,\n\tMultipleValuesPattern,\n\tNotTriplesPatternBuilder,\n\tSingleValuesPattern,\n\tSupportedNativeTypes,\n\tTriplesNodePattern,\n\tTriplesPatternBuilder,\n} from \"sparqler/patterns\";\nimport {\n\tNotTriplesPattern,\n\tValuesPattern,\n} from \"sparqler/patterns/notTriples\";\nimport {\n\tAS,\n\tBIND,\n\tCLOSE_SINGLE_LIST,\n\tFILTER,\n\tGRAPH,\n\tMINUS,\n\tOPEN_SINGLE_LIST,\n\tOPTIONAL,\n\tSERVICE,\n\tSILENT,\n\tUNION,\n} from \"sparqler/patterns/tokens\";\nimport {\n\tBlankNode,\n\tBooleanLiteral,\n\tCollection,\n\tLiteral,\n\tNumericLiteral,\n\tRDFLiteral,\n\tResource,\n\tVariable,\n} from \"sparqler/patterns/triples\";\nimport {\n\tStringLiteral,\n\tToken,\n} from \"sparqler/tokens\";\nimport { getBlockTokens } from \"sparqler/utils/Patterns\";\n\nexport type Undefined = \"UNDEF\";\nexport class PatternBuilder implements TriplesPatternBuilder,\n                                       NotTriplesPatternBuilder {\n\n\tpublic static get undefined():Undefined { return \"UNDEF\"; };\n\n\tpublic get undefined():Undefined { return PatternBuilder.undefined; };\n\n\tprivate resolver:IRIResolver;\n\n\tconstructor( resolver:IRIResolver ) {\n\t\tthis.resolver = resolver;\n\t}\n\n\tresource( iri:string ):Resource {\n\t\treturn new Resource( this.resolver, iri );\n\t}\n\n\tvar( name:string ):Variable {\n\t\treturn new Variable( this.resolver, name );\n\t}\n\n\tliteral( value:string ):RDFLiteral;\n\tliteral( value:number ):NumericLiteral;\n\tliteral( value:boolean ):BooleanLiteral;\n\tliteral( value ):any {\n\t\tif( typeof value === \"string\" || value instanceof String )\n\t\t\treturn new RDFLiteral( this.resolver, value as string );\n\n\t\tif( typeof value === \"number\" || value instanceof Number )\n\t\t\treturn new NumericLiteral( this.resolver, value as number );\n\n\t\tif( typeof value === \"boolean\" || value instanceof Boolean )\n\t\t\treturn new BooleanLiteral( this.resolver, value as boolean );\n\n\t\tthrow new Error( \"InvalidArgumentError: No valid value of a literal was provided.\" );\n\t}\n\n\tcollection( ...values:(SupportedNativeTypes | Resource | Variable | Literal | TriplesNodePattern)[] ):Collection {\n\t\tif( values.length === 0 ) throw Error( \"InvalidArgumentError: The collection needs at least one value.\" );\n\t\treturn new Collection( this.resolver, values );\n\t}\n\n\tblankNode():BlankNode {\n\t\treturn new BlankNode( this.resolver );\n\t}\n\n\tgraph( iri:string, pattern:GraphPattern ):NotTriplesPattern;\n\tgraph( iri:string, patterns:GraphPattern[] ):NotTriplesPattern;\n\tgraph( variable:Variable, pattern:GraphPattern ):NotTriplesPattern;\n\tgraph( variable:Variable, patterns:GraphPattern[] ):NotTriplesPattern;\n\tgraph( iriOrVariable, patterns ):NotTriplesPattern {\n\t\tlet graph:Token[] = ( typeof iriOrVariable === \"string\" )\n\t\t\t? this.resolver._resolveIRI( iriOrVariable )\n\t\t\t: iriOrVariable.getSelfTokens();\n\n\t\tlet patternTokens:Token[] = getBlockTokens( patterns );\n\t\treturn new NotTriplesPattern( [ GRAPH, ...graph, ...patternTokens ] );\n\t}\n\n\toptional( pattern:GraphPattern ):NotTriplesPattern;\n\toptional( patterns:GraphPattern[] ):NotTriplesPattern;\n\toptional( patterns ):NotTriplesPattern {\n\t\tlet patternTokens:Token[] = getBlockTokens( patterns );\n\n\t\treturn new NotTriplesPattern( [ OPTIONAL, ...patternTokens ] );\n\t}\n\n\tunion( pattern1:GraphPattern, pattern2:GraphPattern ):NotTriplesPattern;\n\tunion( pattern1:GraphPattern, patterns2:GraphPattern[] ):NotTriplesPattern;\n\tunion( patterns1:GraphPattern[], pattern2:GraphPattern ):NotTriplesPattern;\n\tunion( patterns1:GraphPattern[], patterns2:GraphPattern[] ):NotTriplesPattern;\n\tunion( patterns1, patterns2 ):NotTriplesPattern {\n\t\tlet leftPatternTokens:Token[] = getBlockTokens( patterns1 );\n\t\tlet rightPatternTokens:Token[] = getBlockTokens( patterns2 );\n\n\t\treturn new NotTriplesPattern( [ ...leftPatternTokens, UNION, ...rightPatternTokens ] );\n\t}\n\n\tminus( pattern:GraphPattern ):NotTriplesPattern;\n\tminus( firstPattern:GraphPattern, ...restPatterns:GraphPattern[] ):NotTriplesPattern;\n\tminus( ...patterns:GraphPattern[] ):NotTriplesPattern {\n\t\tlet patternTokens:Token[] = getBlockTokens( patterns );\n\n\t\treturn new NotTriplesPattern( [ MINUS, ...patternTokens ] );\n\t}\n\n\tvalues( variable:Variable ):SingleValuesPattern;\n\tvalues( ...variables:Variable[] ):MultipleValuesPattern;\n\tvalues( ...variables:Variable[] ):SingleValuesPattern | MultipleValuesPattern {\n\t\treturn new ValuesPattern( this.resolver, variables );\n\t}\n\n\tservice( resource:string | Resource | Variable, patterns:GraphPattern | GraphPattern[] ):NotTriplesPattern {\n\t\tconst serviceTokens:Token[] = typeof resource === \"string\" ?\n\t\t\tthis.resolver._resolveIRI( resource ) :\n\t\t\tresource.getSelfTokens();\n\n\t\tconst patternTokens:Token[] = getBlockTokens( patterns );\n\t\treturn new NotTriplesPattern( [ SERVICE, ...serviceTokens, ...patternTokens ] );\n\t}\n\n\tserviceSilent( resource:string | Resource | Variable, patterns:GraphPattern | GraphPattern[] ):NotTriplesPattern {\n\t\tconst serviceTokens:Token[] = typeof resource === \"string\" ?\n\t\t\tthis.resolver._resolveIRI( resource ) :\n\t\t\tresource.getSelfTokens();\n\n\t\tconst patternTokens:Token[] = getBlockTokens( patterns );\n\t\treturn new NotTriplesPattern( [ SERVICE, SILENT, ...serviceTokens, ...patternTokens ] );\n\t}\n\n\tbind( rawExpression:string, variable:string | Variable ):NotTriplesPattern {\n\t\tvariable = typeof variable === \"string\" ? this.var( variable ) : variable;\n\t\tconst patternTokens:Token[] = [ BIND, OPEN_SINGLE_LIST, new StringLiteral( rawExpression ), AS, ...variable.getSelfTokens(), CLOSE_SINGLE_LIST ];\n\t\treturn new NotTriplesPattern( patternTokens );\n\t}\n\n\tfilter( rawConstraint:string ):NotTriplesPattern {\n\t\treturn new NotTriplesPattern( [ FILTER, new StringLiteral( rawConstraint ) ] );\n\t}\n\n}\n\nexport default PatternBuilder;"]}